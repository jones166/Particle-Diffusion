(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     22246,        567]
NotebookOptionsPosition[     20437,        531]
NotebookOutlinePosition[     20968,        550]
CellTagsIndexPosition[     20925,        547]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Particle Diffusion", "Title",
 CellChangeTimes->{{3.8588655229978256`*^9, 
  3.858865535611528*^9}},ExpressionUUID->"e76d2cdb-adec-4981-9235-\
db52ed9c9000"],

Cell["Michael Jones and Ian Jackson", "Author",
 CellChangeTimes->{{3.858865543052256*^9, 
  3.858865553692855*^9}},ExpressionUUID->"c4869ef1-dbd2-4300-9b07-\
7170b2852407"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<Units`\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.8588646496531277`*^9, 3.8588646545153856`*^9}, {
  3.858871778207058*^9, 3.8588717890235167`*^9}},
 CellLabel->
  "In[674]:=",ExpressionUUID->"ee3b8de3-e3f1-44a2-8b79-4401803dbfea"],

Cell["Start by creating a GUI window", "Text",
 CellChangeTimes->{{3.8588655596221204`*^9, 
  3.858865565643279*^9}},ExpressionUUID->"535c4ffa-3dcb-40ae-8aba-\
172a39756af7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"f", ",", "p"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", "g_", "]"}], ":=", 
     RowBox[{"Graphics", "[", 
      RowBox[{"g", ",", 
       RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "]"}]}], ";", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"SetterBar", "[", 
       RowBox[{
        RowBox[{"Dynamic", "[", "p", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Disk", "[", "]"}], "\[Rule]", "Disk"}], ",", 
          RowBox[{
           RowBox[{"Rectangle", "[", "]"}], "\[Rule]", "Rectangle"}]}], 
         "}"}]}], "]"}], ",", 
      RowBox[{"Dynamic", "[", 
       RowBox[{"f", "[", "p", "]"}], "]"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.858866656942376*^9, 3.858866656950677*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"ab99badd-6c91-434f-a566-6747e5d892e4"],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`f$$, $CellContext`p$$ = Rectangle[{0, 0}]}, 
  RowBox[{"{", 
   RowBox[{
    InterpretationBox[
     StyleBox[GridBox[{
        {
         SetterBox[Dynamic[$CellContext`p$$], {Disk[{0, 0}]}, "Disk"], 
         SetterBox[Dynamic[$CellContext`p$$], {Rectangle[{0, 0}]}, 
          "Rectangle"]}
       },
       BaselinePosition->{1, 1},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      Deployed->True],
     SetterBar[
      Dynamic[$CellContext`p$$], {
      Disk[{0, 0}] -> Disk, Rectangle[{0, 0}] -> Rectangle}]], ",", 
    DynamicBox[ToBoxes[
      $CellContext`f$$[$CellContext`p$$], StandardForm],
     ImageSizeCache->{100., {47., 52.84000000000002}}]}], "}"}],
  DynamicModuleValues:>{{DownValues[$CellContext`f$$] = {HoldPattern[
         $CellContext`f$$[
          Pattern[$CellContext`g, 
           Blank[]]]] :> 
       Graphics[$CellContext`g, ImageSize -> Tiny]}}}]], "Output",
 CellChangeTimes->{3.8588667000816402`*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"9419eedf-a654-4128-8a93-6c6b81b23970"]
}, Open  ]],

Cell["Create a list of constants", "Text",
 CellChangeTimes->{{3.8588670732857623`*^9, 3.858867092978797*^9}, {
  3.858868033051031*^9, 
  3.8588680394224167`*^9}},ExpressionUUID->"6586d9a2-e167-41d6-8d54-\
d13513b0c71d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", "=", 
   RowBox[{"8.6173*^-5", 
    NamespaceBox["LinguisticAssistant",
     DynamicModuleBox[{Typeset`query$$ = "eV", Typeset`boxes$$ = TemplateBox[{
        InterpretationBox["\[InvisibleSpace]", 1], "\"eV\"", "electronvolts", 
        "\"Electronvolts\""}, "Quantity", SyntaxForm -> Mod], 
      Typeset`allassumptions$$ = {{
       "type" -> "Clash", "word" -> "eV", "template" -> 
        "Assuming \"eV\" is a unit${separator}Use as ${desc} or ${desc} or \
${desc} instead", "count" -> "4", "pulldown" -> "false", "default" -> 
        "{\"C\", \"eV\"} -> {\"Unit\", \"dflt\"}", 
        "Values" -> {{
          "name" -> "Unit", "desc" -> "a unit", "input" -> 
           "{\"C\", \"eV\"} -> {\"Unit\"}"}, {
          "name" -> "Formula", "desc" -> "a formula", "input" -> 
           "{\"C\", \"eV\"} -> {\"Formula\"}"}, {
          "name" -> "Word", "desc" -> "a word", "input" -> 
           "{\"C\", \"eV\"} -> {\"Word\"}"}, {
          "name" -> "Financial", "desc" -> "a financial entity", "input" -> 
           "{\"C\", \"eV\"} -> {\"Financial\"}"}}}, {
       "type" -> "Unit", "word" -> "eV", "template" -> 
        "Assuming electronvolts for \"eV\"${separator}Use ${desc} or \
${pulldown} instead", "count" -> "4", "pulldown" -> "true", "pulldownlabel" -> 
        "more >>", "pulldownlength" -> "2", "default" -> 
        "\"UnitClash\" -> {\"eV\", {\"Electronvolts\", \"dflt\"}}", 
        "Values" -> {{
          "name" -> "Electronvolts", "desc" -> "electronvolts", "input" -> 
           "\"UnitClash\" -> {\"eV\", {\"Electronvolts\"}}"}, {
          "name" -> "ElectronvoltsPerSpeedOfLightSquared", "desc" -> 
           "electronvolts per speed of light squared", "input" -> 
           "\"UnitClash\" -> {\"eV\", \
{\"ElectronvoltsPerSpeedOfLightSquared\"}}"}, {
          "name" -> "MolarElectronvolts", "desc" -> "molar electronvolts", 
           "input" -> 
           "\"UnitClash\" -> {\"eV\", {\"MolarElectronvolts\"}}"}, {
          "name" -> "ElectronvoltsPerBoltzmannConstant", "desc" -> 
           "electronvolts per Boltzmann constant", "input" -> 
           "\"UnitClash\" -> {\"eV\", \
{\"ElectronvoltsPerBoltzmannConstant\"}}"}}}}, Typeset`assumptions$$ = {}, 
      Typeset`open$$ = {1, 2}, Typeset`querystate$$ = {
      "Online" -> True, "Allowed" -> True, "mparse.jsp" -> 
       0.423607`7.078508121598687, "Messages" -> {}}}, 
      DynamicBox[ToBoxes[
        AlphaIntegration`LinguisticAssistantBoxes["", 4, Automatic, 
         Dynamic[Typeset`query$$], 
         Dynamic[Typeset`boxes$$], 
         Dynamic[Typeset`allassumptions$$], 
         Dynamic[Typeset`assumptions$$], 
         Dynamic[Typeset`open$$], 
         Dynamic[Typeset`querystate$$]], StandardForm],
       ImageSizeCache->{87.8, {10., 17.8}},
       TrackedSymbols:>{
        Typeset`query$$, Typeset`boxes$$, Typeset`allassumptions$$, 
         Typeset`assumptions$$, Typeset`open$$, Typeset`querystate$$}],
      DynamicModuleValues:>{},
      UndoTrackedVariables:>{Typeset`open$$}],
     BaseStyle->{"Deploy"},
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", "=", "300"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"atom", "=", "\"\<Hydrogen\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", 
   RowBox[{"ElementData", "[", 
    RowBox[{"atom", ",", "\"\<AtomicMass\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", 
   RowBox[{"UnitConvert", "[", 
    RowBox[{"m", ",", "\"\<MeV/c^2\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "=", 
   RowBox[{"UnitConvert", "[", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{"3", " ", "k", " ", 
       RowBox[{"T", "/", "m"}]}], "]"}], ",", "\"\<m/s\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simV", "=", 
   RowBox[{
    RowBox[{"QuantityMagnitude", "[", "v", "]"}], "/", "10000"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "=", 
   RowBox[{"ElementData", "[", 
    RowBox[{"atom", ",", "\"\<AtomicRadius\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simR", "=", 
   RowBox[{
    RowBox[{"QuantityMagnitude", "[", "R", "]"}], "/", "1000"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]", "=", 
   RowBox[{"Pi", " ", 
    RowBox[{"R", "^", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"width", "=", "1"}], ";", 
  RowBox[{"(*", 
   RowBox[{"Corresponds", " ", "to", " ", "um"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"height", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"n", ">", "objectMax"}], ",", 
    RowBox[{"n", "=", "objectMax"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxX", "=", 
   RowBox[{"Floor", "[", 
    RowBox[{"width", "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", "simR"}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxY", "=", 
   RowBox[{"Floor", "[", 
    RowBox[{"height", "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", "simR"}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"objectMax", "=", 
   RowBox[{"maxX", " ", "maxY"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8588673667054358`*^9, 3.858867371788509*^9}, {
   3.858867405560193*^9, 3.8588674089834366`*^9}, {3.858867462724923*^9, 
   3.858867486648549*^9}, {3.858867533829311*^9, 3.8588675357455277`*^9}, {
   3.858867600004614*^9, 3.858867726206031*^9}, {3.858867917147211*^9, 
   3.8588679394159036`*^9}, {3.8588680510486407`*^9, 
   3.8588680592536836`*^9}, {3.8588681157337427`*^9, 
   3.8588681263629932`*^9}, {3.8588681627297745`*^9, 
   3.8588681677327504`*^9}, {3.8588682198352365`*^9, 3.858868228506979*^9}, {
   3.8588683654353237`*^9, 3.8588683779294033`*^9}, {3.8588684468213453`*^9, 
   3.858868490029476*^9}, {3.8588685230027475`*^9, 3.858868531133768*^9}, {
   3.8588687312364435`*^9, 3.8588687438837504`*^9}, {3.8588687967937136`*^9, 
   3.8588688289852047`*^9}, {3.8588688794142365`*^9, 
   3.8588689654057837`*^9}, {3.8588690082540083`*^9, 3.858869008380858*^9}, {
   3.8588690472443533`*^9, 3.858869047745919*^9}, {3.858869392397538*^9, 
   3.858869483401599*^9}, {3.8588695871193757`*^9, 3.8588695877716675`*^9}, {
   3.858869800846696*^9, 3.8588699163251505`*^9}, 3.858870154680781*^9, {
   3.858870509136773*^9, 3.85887053483971*^9}, 3.858871052327323*^9, 
   3.8588713121808715`*^9, {3.8588713710092793`*^9, 3.858871428124514*^9}, {
   3.8588716588612003`*^9, 3.8588716647905006`*^9}, {3.8588717345745773`*^9, 
   3.8588717378873773`*^9}, {3.8588718250766506`*^9, 
   3.8588718271834316`*^9}, {3.8588719119548807`*^9, 
   3.8588719915088234`*^9}, {3.8588724147880974`*^9, 3.858872470474654*^9}, {
   3.8588728744322124`*^9, 3.858872882736228*^9}},
 CellLabel->
  "In[894]:=",ExpressionUUID->"152c70bd-8319-4a09-8d35-95702e3fcb16"],

Cell["Create an array of n elements", "Text",
 CellChangeTimes->{{3.8588680283617363`*^9, 3.858868028957449*^9}, {
  3.8588680672609158`*^9, 3.858868071722904*^9}, {3.8588681758957434`*^9, 
  3.8588681790036435`*^9}},ExpressionUUID->"318599dd-822d-4a34-865f-\
b0da814a81e3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rows", "=", 
   RowBox[{"Floor", "[", 
    RowBox[{"Sqrt", "[", "n", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cols", "=", 
   RowBox[{"rows", "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stepX", "=", 
   RowBox[{"width", "/", 
    RowBox[{"(", 
     RowBox[{"cols", "+", "1"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stepY", "=", 
   RowBox[{"height", "/", 
    RowBox[{"(", 
     RowBox[{"rows", "+", "1"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"counterX", "=", "stepX"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"counterY", "=", "stepY"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"objectList", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"objectList", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"objectList", ",", 
       RowBox[{"{", 
        RowBox[{"counterX", ",", "counterY"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"counterX", "=", 
     RowBox[{"counterX", "+", "stepX"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"counterX", ">", 
       RowBox[{"width", "-", "simR"}]}], ",", 
      RowBox[{
       RowBox[{"counterX", "=", "stepX"}], ";", 
       RowBox[{"counterY", "=", 
        RowBox[{"counterY", "+", "stepY"}]}]}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", "n"}], 
  "]"}], "\[IndentingNewLine]", "objectList", "\[IndentingNewLine]", 
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Black", ",", 
       RowBox[{"Disk", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "simR"}], "]"}]}], 
      "}"}], "&"}], "/@", "objectList"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "width"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "height"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.858868205954157*^9, 3.8588682109685884`*^9}, {
   3.858868242779641*^9, 3.858868246836707*^9}, {3.858868293362693*^9, 
   3.858868382635501*^9}, 3.858868750693562*^9, {3.8588688060578794`*^9, 
   3.8588688070950184`*^9}, {3.8588690134075966`*^9, 3.858869030815649*^9}, {
   3.85886952868794*^9, 3.8588696226284328`*^9}, {3.8588696871255236`*^9, 
   3.8588697492850485`*^9}, {3.858869974355496*^9, 3.8588699922900815`*^9}, {
   3.8588700418412905`*^9, 3.858870139682889*^9}, {3.8588701791767116`*^9, 
   3.8588702205198703`*^9}, {3.858870253606736*^9, 3.8588703281148996`*^9}, {
   3.8588705626555986`*^9, 3.8588706894522877`*^9}, {3.8588707319670296`*^9, 
   3.858870741330265*^9}, {3.858870791314489*^9, 3.858870991339217*^9}, {
   3.858871043538343*^9, 3.8588710440303535`*^9}, {3.858871093609243*^9, 
   3.8588711124149923`*^9}, {3.8588712735551786`*^9, 3.858871304816064*^9}, {
   3.8588713409907484`*^9, 3.858871361889736*^9}},
 CellLabel->
  "In[572]:=",ExpressionUUID->"cd5a5e81-5511-4f35-acf4-aef3cde2fc7a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    FractionBox["1", "3"], ",", 
    FractionBox["1", "2"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.858870071982373*^9, {3.8588701048526382`*^9, 3.8588701399942045`*^9}, 
   3.8588701862300186`*^9, 3.8588702209170303`*^9, 3.858870338774144*^9, {
   3.8588705134714794`*^9, 3.8588705217477636`*^9}, {3.858870958594932*^9, 
   3.8588709917572355`*^9}, {3.8588710444958515`*^9, 3.858871055609991*^9}, {
   3.8588713056978917`*^9, 3.8588714301316757`*^9}},
 CellLabel->
  "Out[580]=",ExpressionUUID->"2167459e-de1e-493d-ba2e-73e0b9c63e16"],

Cell[BoxData[
 GraphicsBox[
  {GrayLevel[0], 
   DiskBox[NCache[{Rational[1, 3], Rational[1, 2]}, {0.3333333333333333, 
     0.5}], 0.053]},
  Frame->True,
  PlotRange->{{0, 1}, {0, 1}}]], "Output",
 CellChangeTimes->{
  3.858870071982373*^9, {3.8588701048526382`*^9, 3.8588701399942045`*^9}, 
   3.8588701862300186`*^9, 3.8588702209170303`*^9, 3.858870338774144*^9, {
   3.8588705134714794`*^9, 3.8588705217477636`*^9}, {3.858870958594932*^9, 
   3.8588709917572355`*^9}, {3.8588710444958515`*^9, 3.858871055609991*^9}, {
   3.8588713056978917`*^9, 3.858871430134587*^9}},
 CellLabel->
  "Out[581]=",ExpressionUUID->"e3a8412a-bb60-4ac4-b91a-393e3f11e754"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tracked", "=", 
   RowBox[{
    RowBox[{"Floor", "[", 
     RowBox[{"n", "/", "2"}], "]"}], "+", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"objectV", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"vRatio", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Vy", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", 
         RowBox[{"RandomInteger", "[", "1", "]"}]}], ")"}], " ", 
       RowBox[{"simV", "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"vRatio", "^", "2"}], "+", "1"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"objectV", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"objectV", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vRatio", " ", "Vy"}], ",", "Vy"}], "}"}]}], "]"}]}]}], ",",
     "\[IndentingNewLine]", "n"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.858870368157754*^9, 3.8588703787457895`*^9}, 
   3.8588714392641125`*^9, {3.858871570594591*^9, 3.858871591915722*^9}, {
   3.8588720051800375`*^9, 3.8588720458336525`*^9}, {3.858872090557619*^9, 
   3.858872136996363*^9}, {3.8588723458143115`*^9, 3.85887239341339*^9}, {
   3.8588724791301928`*^9, 3.858872486551503*^9}, {3.8588728200876207`*^9, 
   3.8588728206929455`*^9}, {3.8588729150074167`*^9, 3.85887291792023*^9}, {
   3.858872952307709*^9, 3.858873010067692*^9}},
 CellLabel->
  "In[970]:=",ExpressionUUID->"5efd5958-9241-4b1d-a942-08539079262e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"move", "[", "i_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"objectList", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
          RowBox[{"width", "-", "simR"}]}], "||", 
         RowBox[{
          RowBox[{"objectList", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "<", "simR"}]}], ",", 
        RowBox[{
         RowBox[{"objectV", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
         RowBox[{"-", 
          RowBox[{"objectV", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"objectList", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], ">", 
          RowBox[{"height", "-", "simR"}]}], "||", 
         RowBox[{
          RowBox[{"objectList", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "<", "simR"}]}], ",", 
        RowBox[{
         RowBox[{"objectV", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
         RowBox[{"-", 
          RowBox[{"objectV", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"objectList", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"objectList", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
        RowBox[{"objectV", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"objectList", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"objectList", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
        RowBox[{"objectV", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.858872527717432*^9, 3.8588725546054335`*^9}, {
  3.8588726180544605`*^9, 3.8588726208176737`*^9}, {3.858872664439868*^9, 
  3.858872777290248*^9}, {3.858872894575124*^9, 3.858872907776395*^9}, {
  3.858873101928276*^9, 3.8588731259668255`*^9}},
 CellLabel->
  "In[974]:=",ExpressionUUID->"3a61cc8b-83fb-4777-91dc-0a615ddbba8e"]
}, Open  ]]
},
WindowSize->{1152., 585.6},
WindowMargins->{{
  Automatic, -5.399999999999864}, {-5.399999999999977, Automatic}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"6d99f1f6-1478-4b9a-b3f7-ecd1c1545660"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 163, 3, 97, "Title",ExpressionUUID->"e76d2cdb-adec-4981-9235-db52ed9c9000"],
Cell[746, 27, 173, 3, 31, "Author",ExpressionUUID->"c4869ef1-dbd2-4300-9b07-7170b2852407"],
Cell[922, 32, 345, 6, 49, "Input",ExpressionUUID->"ee3b8de3-e3f1-44a2-8b79-4401803dbfea"],
Cell[1270, 40, 174, 3, 35, "Text",ExpressionUUID->"535c4ffa-3dcb-40ae-8aba-172a39756af7"],
Cell[CellGroupData[{
Cell[1469, 47, 933, 26, 49, "Input",ExpressionUUID->"ab99badd-6c91-434f-a566-6747e5d892e4"],
Cell[2405, 75, 1261, 32, 118, "Output",ExpressionUUID->"9419eedf-a654-4128-8a93-6c6b81b23970"]
}, Open  ]],
Cell[3681, 110, 221, 4, 35, "Text",ExpressionUUID->"6586d9a2-e167-41d6-8d54-d13513b0c71d"],
Cell[3905, 116, 7068, 157, 356, "Input",ExpressionUUID->"152c70bd-8319-4a09-8d35-95702e3fcb16"],
Cell[10976, 275, 274, 4, 35, "Text",ExpressionUUID->"318599dd-822d-4a34-865f-b0da814a81e3"],
Cell[CellGroupData[{
Cell[11275, 283, 3308, 83, 263, "Input",ExpressionUUID->"cd5a5e81-5511-4f35-acf4-aef3cde2fc7a"],
Cell[14586, 368, 603, 13, 48, "Output",ExpressionUUID->"2167459e-de1e-493d-ba2e-73e0b9c63e16"],
Cell[15192, 383, 656, 14, 373, "Output",ExpressionUUID->"e3a8412a-bb60-4ac4-b91a-393e3f11e754"]
}, Open  ]],
Cell[15863, 400, 1755, 47, 127, "Input",ExpressionUUID->"5efd5958-9241-4b1d-a942-08539079262e"],
Cell[17621, 449, 2800, 79, 127, "Input",ExpressionUUID->"3a61cc8b-83fb-4777-91dc-0a615ddbba8e"]
}, Open  ]]
}
]
*)

